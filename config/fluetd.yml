<source>
  @type tail
  path /var/host/log/messages  # ì‹œìŠ¤í…œ ë©”ì‹œì§€ ë¡œê·¸ íŒŒì¼
  pos_file /var/host/log/messages.pos  # ì¤‘ë³µ ë¡œê·¸ ë°©ì§€ë¥¼ ìœ„í•œ ìœ„ì¹˜ ì €ì¥ íŒŒì¼
  @id input_messages
  tag messages
  <parse>
    @type none  # ë¡œê·¸ íŒŒì‹± ì—†ì´ ì›ë³¸ ê·¸ëŒ€ë¡œ ì €ì¥
  </parse>
</source>

<source>
  @type tail
  path /var/host/log/secure  # ë³´ì•ˆ ê´€ë ¨ ë¡œê·¸ íŒŒì¼
  pos_file /var/host/log/secure.pos
  @id input_secure
  tag secure
  <parse>
    @type none
  </parse>
</source>

<source>
  @type tail
  path /var/host/log/observe/wtmp.txt  # ì‚¬ìš©ì ë¡œê·¸ì¸ ê¸°ë¡ (wtmp)
  pos_file /var/host/log/wtmp.pos
  @id input_wtmp
  tag wtmp
  <parse>
    @type none
  </parse>
</source>

<source>
  @type tail
  path /var/host/log/observe/btmp.txt  # ë¡œê·¸ì¸ ì‹¤íŒ¨ ê¸°ë¡ (btmp)
  pos_file /var/host/log/btmp.pos
  @id input_btmp
  tag btmp
  <parse>
    @type none
  </parse>
</source>

<source>
  @type tail
  path /var/host/log/windows/example-ip-1  # Windows ì„œë²„ 1ì˜ ë¡œê·¸ íŒŒì¼
  pos_file /var/host/log/windows/example-ip-1.pos
  @id input_windows_example_ip_1
  tag windows_example_ip_1
  <parse>
    @type none
  </parse>
</source>

<source>
  @type tail
  path /var/host/log/windows/example-ip-2  # Windows ì„œë²„ 2ì˜ ë¡œê·¸ íŒŒì¼
  pos_file /var/host/log/windows/example-ip-2.pos
  @id input_windows_example_ip_2
  tag windows_example_ip_2
  <parse>
    @type none
  </parse>
</source>

<match messages>
  @type s3
  s3_endpoint https://example-ip:449  # S3 í˜¸í™˜ ìŠ¤í† ë¦¬ì§€ (MinIO ë“±)
  s3_bucket log
  s3_force_path_style true
  aws_key_id ${AWS_ACCESS_KEY_ID}  # í™˜ê²½ë³€ìˆ˜ë¡œ ë³´ì•ˆ ê°•í™”
  aws_sec_key ${AWS_SECRET_ACCESS_KEY}  # í™˜ê²½ë³€ìˆ˜ë¡œ ë³´ì•ˆ ê°•í™”
  s3_region null
  s3_object_key_format "/%Y-%m-%d/${myip}/messages-%H-%{uuid_flush}%{tag}.gz"
  time_slice_format %y%m%d%H
  time_slice_wait 1m
  scheme https
  cert_path /fluentd/etc/public.crt  # TLS ì¸ì¦ì„œ ì‚¬ìš©
  private_key_path /fluentd/etc/private.np.key

  <buffer>
    @type memory  # ë©”ëª¨ë¦¬ ë²„í¼ ì‚¬ìš© (ë””ìŠ¤í¬ ì €ì¥ ê°€ëŠ¥)
    flush_mode interval
    flush_interval 1h  # 1ì‹œê°„ë§ˆë‹¤ ì—…ë¡œë“œ
    flush_thread_count 2
    retry_max_interval 30
    overflow_action block
  </buffer>
</match>

<match secure>
  @type s3
  s3_endpoint https://example-ip:449
  s3_bucket log
  s3_force_path_style true
  aws_key_id ${AWS_ACCESS_KEY_ID}
  aws_sec_key ${AWS_SECRET_ACCESS_KEY}
  s3_region null
  s3_object_key_format "/%Y-%m-%d/${myip}/secure-%H-%{uuid_flush}%{tag}.gz"
  time_slice_format %y%m%d%H
  time_slice_wait 1m
  scheme https
  cert_path /fluentd/etc/public.crt
  private_key_path /fluentd/etc/private.np.key

  <buffer>
    @type memory
    flush_mode interval
    flush_interval 1h
    flush_thread_count 2
    retry_max_interval 30
    overflow_action block
  </buffer>
</match>

# ğŸ“Œ Windows ë¡œê·¸ ì €ì¥ (Example IP ì‚¬ìš©)
<match windows_example_ip_1>
  @type s3
  s3_endpoint https://example-ip:449
  s3_bucket log
  s3_force_path_style true
  aws_key_id ${AWS_ACCESS_KEY_ID}
  aws_sec_key ${AWS_SECRET_ACCESS_KEY}
  s3_region null
  s3_object_key_format "/%Y-%m-%d/example-ip-1/windows-%H-%{uuid_flush}%{tag}.gz"
  time_slice_format %y%m%d%H
  time_slice_wait 1m
  scheme https
  cert_path /fluentd/etc/public.crt
  private_key_path /fluentd/etc/private.np.key

  <buffer>
    @type memory
    flush_mode interval
    flush_interval 1h
    flush_thread_count 2
    retry_max_interval 30
    overflow_action block
  </buffer>
</match>

<match windows_example_ip_2>
  @type s3
  s3_endpoint https://example-ip:449
  s3_bucket log
  s3_force_path_style true
  aws_key_id ${AWS_ACCESS_KEY_ID}
  aws_sec_key ${AWS_SECRET_ACCESS_KEY}
  s3_region null
  s3_object_key_format "/%Y-%m-%d/example-ip-2/windows-%H-%{uuid_flush}%{tag}.gz"
  time_slice_format %y%m%d%H
  time_slice_wait 1m
  scheme https
  cert_path /fluentd/etc/public.crt
  private_key_path /fluentd/etc/private.np.key

  <buffer>
    @type memory
    flush_mode interval
    flush_interval 1h
    flush_thread_count 2
    retry_max_interval 30
    overflow_action block
  </buffer>
</match>
